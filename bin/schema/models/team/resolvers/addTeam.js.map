{"version":3,"sources":["../../../../../src/schema/models/team/resolvers/addTeam.js"],"names":["requireAuth","createResolver","parent","args","models","user","response","sequelize","transaction","team","Team","create","owner","id","Channel","name","public","teamId","console","log","ok","err","error","errors"],"mappings":"6FAAA,wEACA,oFACA,wD,ysBAEeA,wBAAYC,cAAZ,CACX,MAAOC,MAAP,CAAeC,IAAf,CAAqB,CAAEC,MAAF,CAAUC,IAAV,CAArB,GAA0C,CACtC,GAAI,CACA,KAAMC,CAAAA,QAAQ,CAAG,KAAMF,CAAAA,MAAM,CAACG,SAAP,CAAiBC,WAAjB,CACnB,SAAY,CACR,KAAMC,CAAAA,IAAI,CAAG,KAAML,CAAAA,MAAM,CAACM,IAAP,CAAYC,MAAZ,kBACZR,IADY,EAEfS,KAAK,CAAEP,IAAI,CAACQ,EAFG,GAAnB,CAIA,KAAMT,CAAAA,MAAM,CAACU,OAAP,CAAeH,MAAf,CAAsB,CACxBI,IAAI,CAAE,SADkB,CAExBC,MAAM,CAAE,IAFgB,CAGxBC,MAAM,CAAER,IAAI,CAACI,EAHW,CAAtB,CAAN,CAKA,MAAOJ,CAAAA,IAAP,CACH,CAZkB,CAAvB,CAcAS,OAAO,CAACC,GAAR,CAAYb,QAAZ,EACA,MAAO,CACHc,EAAE,CAAE,IADD,CAEHX,IAAI,CAAEH,QAFH,CAAP,CAIH,CAAC,MAAOe,GAAP,CAAY,CACVF,gBAAIG,KAAJ,CAAUD,GAAV,EACA,MAAO,CACHD,EAAE,CAAE,KADD,CAEHG,MAAM,CAAE,0BAAaF,GAAb,CAAkBjB,MAAlB,CAFL,CAAP,CAIH,CACJ,CA7BU,C","sourcesContent":["import log from \"../../../../utils/logger\";\nimport formatErrors from '../../../../utils/formatErrors'\nimport { requireAuth } from '../../../../utils/permission'\n\nexport default requireAuth.createResolver(\n    async (parent, args, { models, user }) => {\n        try {\n            const response = await models.sequelize.transaction(\n                async () => {\n                    const team = await models.Team.create({\n                        ...args,\n                        owner: user.id\n                    })\n                    await models.Channel.create({\n                        name: 'general',\n                        public: true,\n                        teamId: team.id\n                    })\n                    return team\n                }\n            )\n            console.log(response)\n            return {\n                ok: true,\n                team: response\n            }\n        } catch (err) {\n            log.error(err)\n            return {\n                ok: false,\n                errors: formatErrors(err, models)\n            }\n        }\n    }\n)"],"file":"addTeam.js"}