{"version":3,"sources":["../../../../../src/schema/models/team/resolvers/addTeam.js"],"names":["requireAuth","createResolver","parent","args","models","user","response","sequelize","transaction","team","Team","create","Channel","name","public","teamId","id","Member","userId","admin","ok","err","log","error","errors"],"mappings":"6FAAA,wEACA,oFACA,wD,ohCAEeA,wBAAYC,cAAZ,CACX,MAAOC,MAAP,CAAeC,IAAf,CAAqB,CAACC,MAAD,CAASC,IAAT,CAArB,GAAwC,CACpC,GAAI,CACA,KAAMC,CAAAA,QAAQ,CAAG,KAAMF,CAAAA,MAAM,CAACG,SAAP,CAAiBC,WAAjB,CAA6B,SAAY,CAC5D,KAAMC,CAAAA,IAAI,CAAG,KAAML,CAAAA,MAAM,CAACM,IAAP,CAAYC,MAAZ,kBAAuBR,IAAvB,EAAnB,CAEA,KAAMC,CAAAA,MAAM,CAACQ,OAAP,CAAeD,MAAf,CAAsB,CACxBE,IAAI,CAAE,SADkB,CAExBC,MAAM,CAAE,IAFgB,CAGxBC,MAAM,CAAEN,IAAI,CAACO,EAHW,CAAtB,CAAN,CAKA,KAAMZ,CAAAA,MAAM,CAACa,MAAP,CAAcN,MAAd,CAAqB,CACvBI,MAAM,CAAEN,IAAI,CAACO,EADU,CAEvBE,MAAM,CAAEb,IAAI,CAACW,EAFU,CAGvBG,KAAK,CAAE,IAHgB,CAArB,CAAN,CAKA,MAAOV,CAAAA,IAAP,CACH,CAdsB,CAAvB,CAgBA,MAAO,CACHW,EAAE,CAAE,IADD,CAEHX,IAAI,CAAEH,QAFH,CAAP,CAIH,CAAC,MAAOe,GAAP,CAAY,CACVC,gBAAIC,KAAJ,CAAUF,GAAV,EACA,MAAO,CACHD,EAAE,CAAE,KADD,CAEHI,MAAM,CAAE,0BAAaH,GAAb,CAAkBjB,MAAlB,CAFL,CAAP,CAIH,CACJ,CA9BU,C","sourcesContent":["import log from \"../../../../utils/logger\";\nimport formatErrors from \"../../../../utils/formatErrors\";\nimport {requireAuth} from \"../../../../utils/permission\";\n\nexport default requireAuth.createResolver(\n    async (parent, args, {models, user}) => {\n        try {\n            const response = await models.sequelize.transaction(async () => {\n                const team = await models.Team.create({...args});\n\n                await models.Channel.create({\n                    name: \"general\",\n                    public: true,\n                    teamId: team.id,\n                });\n                await models.Member.create({\n                    teamId: team.id,\n                    userId: user.id,\n                    admin: true,\n                });\n                return team;\n            });\n\n            return {\n                ok: true,\n                team: response,\n            };\n        } catch (err) {\n            log.error(err);\n            return {\n                ok: false,\n                errors: formatErrors(err, models),\n            };\n        }\n    },\n);\n"],"file":"addTeam.js"}