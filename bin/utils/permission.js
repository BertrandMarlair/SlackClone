"use strict";Object.defineProperty(exports,"__esModule",{value:true});exports.requireAdmin=exports.requireAuth=void 0;const createResolver=resolver=>{const baseResolver=resolver;baseResolver.createResolver=childResolver=>{const newResolver=async(parent,args,context,info)=>{await resolver(parent,args,context,info);return childResolver(parent,args,context,info);};return createResolver(newResolver);};return baseResolver;};const requireAuth=createResolver((parent,args,{user})=>{if(!user||!user.id){throw new Error("Not authenticated");}});exports.requireAuth=requireAuth;const requireAdmin=requireAuth.createResolver((parent,args,{user})=>{if(!user.isAdmin){throw new Error("Requires admin access");}});exports.requireAdmin=requireAdmin;
//# sourceMappingURL=permission.js.map